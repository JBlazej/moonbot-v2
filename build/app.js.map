{"version":3,"sources":["../src/app.js"],"names":["app","use","express","static","__dirname","bodyParser","json","urlencoded","extended","path","join","router","set","process","env","PORT","listen","get","console","log","shuttingDown","req","res","next","setHeader","err","Error","status","send","message"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA;;AAEA;;;AAGA,IAAMA,MAAM,wBAAZ;AACA;;;AAGA;AACA;AACA;AACAA,IAAIC,GAAJ,CAAQ,kCAAR;AACA;AACAD,IAAIC,GAAJ,CAAQ,SAAR,EAAmBC,kBAAQC,MAAR,CAAeC,YAAY,WAA3B,CAAnB;AACA;AACAJ,IAAIC,GAAJ,CAAQI,qBAAWC,IAAX,EAAR;AACAN,IAAIC,GAAJ,CAAQI,qBAAWE,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACA;AACAR,IAAIC,GAAJ,CAAQ,6BAAR;AACA;AACAD,IAAIC,GAAJ,CAAQ,4BAAaQ,eAAKC,IAAL,CAAUN,SAAV,EAAqB,WAArB,EAAkC,aAAlC,CAAb,CAAR;AACA;AACAJ,IAAIC,GAAJ,CAAQU,gBAAR;AACA;AACAX,IAAIY,GAAJ,CAAQ,MAAR,EAAiBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAArC;;AAEA;AACA;;AAEA;;;AAGAf,IAAIgB,MAAJ,CAAWhB,IAAIiB,GAAJ,CAAQ,MAAR,CAAX,EAA4B,YAAM;AAC9BC,YAAQC,GAAR,CACE,kDADF,EAEEnB,IAAIiB,GAAJ,CAAQ,MAAR,CAFF,EAGEjB,IAAIiB,GAAJ,CAAQ,KAAR,CAHF;AAKAC,YAAQC,GAAR,CAAY,uBAAZ;AACH,CAPD;AAQA;;AAEA;;AAEA;AACA,IAAIC,eAAe,KAAnB;;AAEApB,IAAIC,GAAJ,CAAQ,UAACoB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,QAAI,CAACH,YAAL,EAAmB,OAAOG,MAAP;;AAEnBD,QAAIE,SAAJ,CAAc,YAAd,EAA4B,OAA5B;AACA,QAAMC,MAAM,IAAIC,KAAJ,CAAU,wCAAV,CAAZ;AACAD,QAAIE,MAAJ,GAAa,GAAb;AACAJ,SAAKE,GAAL;AACH,CAPD;;AASAzB,IAAIC,GAAJ,CAAQ,UAACoB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,QAAME,MAAM,IAAIC,KAAJ,CAAU,WAAV,CAAZ;AACAD,QAAIE,MAAJ,GAAa,GAAb;AACAJ,SAAKE,GAAL;AACH,CAJD;;AAMAzB,IAAIC,GAAJ,CAAQ,UAACwB,GAAD,EAAMJ,GAAN,EAAWC,GAAX,EAAgBC,IAAhB,EAAyB;AAC7BD,QAAIK,MAAJ,CAAWF,IAAIE,MAAJ,IAAc,GAAzB;AACAT,YAAQC,GAAR,CAAYM,GAAZ;AACAH,QAAIM,IAAJ,CAAS,EAAC,SAASH,IAAII,OAAd,EAAT;AACA,QAAI7B,IAAIiB,GAAJ,CAAQ,KAAR,MAAmB,aAAvB,EAAsC;AAClCC,gBAAQC,GAAR,CAAYM,GAAZ;AACH;AACJ,CAPD;;kBASezB,G","file":"app.js","sourcesContent":["import 'babel-polyfill'\nimport express from 'express'\nimport bodyParser from 'body-parser'\nimport serveFavicon from 'serve-favicon'\nimport sslRedirect from 'heroku-ssl-redirect'\nimport cookieParser from 'cookie-parser'\nimport path from 'path'\nimport router from './router'\nimport {connectDB} from './models'\nimport {sigterm} from './services/sigterm'\n\n//import {getHackerTemplate, sendHackerTemplate} from './bot/hacker'\n\n/**\n * Start Express server.\n */\nconst app = express()\n/**\n * Setup Express server.\n */\n// HEROKU SIGTERM\nsigterm()\n// SSL\napp.use(sslRedirect())\n// PUBLIC\napp.use('/public', express.static(__dirname + '../public'))\n// BODY\napp.use(bodyParser.json())\napp.use(bodyParser.urlencoded({ extended: true }))\n// COOKIE\napp.use(cookieParser())\n// FAV\napp.use(serveFavicon(path.join(__dirname, '../public', 'favicon.ico')))\n// ROUTER\napp.use(router)\n// PORT\napp.set('port', (process.env.PORT || 3030))\n\n// DB\nconnectDB()\n\n/**\n * Run Express server.\n */\napp.listen(app.get(\"port\"), () => {\n    console.log(\n      \"App is running at http://localhost:%d in %s mode\",\n      app.get(\"port\"),\n      app.get(\"env\")\n    )\n    console.log(\"Press CMD-C to stop\\n\");\n})\n//const h = getHackerTemplate()\n\n//sendHackerTemplate('1959622390785359')\n\n// HANDLINGS ERRORS\nlet shuttingDown = false\n\napp.use((req, res, next) => {\n    if (!shuttingDown) return next()\n  \n    res.setHeader('Connection', 'close')\n    const err = new Error('Server is in the process of restarting')\n    err.status = 503\n    next(err)\n})\n\napp.use((req, res, next) => {\n    const err = new Error('Not Found')\n    err.status = 404\n    next(err)\n})\n  \napp.use((err, req, res, next) => {\n    res.status(err.status || 500)\n    console.log(err)\n    res.send({'error': err.message})\n    if (app.get('env') === 'development') {\n        console.log(err)\n    }\n})\n\nexport default app"]}