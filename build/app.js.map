{"version":3,"sources":["../src/app.js"],"names":["app","use","express","static","__dirname","bodyParser","json","urlencoded","extended","path","join","router","set","process","env","PORT","listen","get","console","log","shuttingDown","req","res","next","setHeader","err","Error","status","send","message"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AAuFA;;;;AArFA;;;;;;;;;;;;;AAaA,IAAMA,MAAM,wBAAZ;;AAEA;;;;AAIAA,IAAIC,GAAJ,CAAQ,kCAAR;AACAD,IAAIC,GAAJ,CAAQ,SAAR,EAAmBC,kBAAQC,MAAR,CAAeC,YAAY,WAA3B,CAAnB;AACAJ,IAAIC,GAAJ,CAAQI,qBAAWC,IAAX,EAAR;AACAN,IAAIC,GAAJ,CAAQI,qBAAWE,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAR,IAAIC,GAAJ,CAAQ,6BAAR;AACAD,IAAIC,GAAJ,CAAQ,4BAAaQ,eAAKC,IAAL,CAAUN,SAAV,EAAqB,WAArB,EAAkC,aAAlC,CAAb,CAAR;AACAJ,IAAIC,GAAJ,CAAQU,gBAAR;;AAEAX,IAAIY,GAAJ,CAAQ,MAAR,EAAiBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAArC;;AAEA;;;;AAIAf,IAAIgB,MAAJ,CAAWhB,IAAIiB,GAAJ,CAAQ,MAAR,CAAX,EAA4B,YAAM;AAC9BC,UAAQC,GAAR,CACE,kDADF,EAEEnB,IAAIiB,GAAJ,CAAQ,MAAR,CAFF,EAGEjB,IAAIiB,GAAJ,CAAQ,KAAR,CAHF;AAKAC,UAAQC,GAAR,CAAY,uBAAZ;AACH,CAPD;;AASA;;;;AAIA;;AAEA;;;;AAIA;AACA;;AAEA;;;;AAIA,IAAIC,eAAe,KAAnB;;AAEApB,IAAIC,GAAJ,CAAQ,UAACoB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,MAAI,CAACH,YAAL,EAAmB,OAAOG,MAAP;;AAEnBD,MAAIE,SAAJ,CAAc,YAAd,EAA4B,OAA5B;AACA,MAAMC,MAAM,IAAIC,KAAJ,CAAU,wCAAV,CAAZ;AACAD,MAAIE,MAAJ,GAAa,GAAb;AACAJ,OAAKE,GAAL;AACH,CAPD;;AASAzB,IAAIC,GAAJ,CAAQ,UAACoB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,MAAME,MAAM,IAAIC,KAAJ,CAAU,WAAV,CAAZ;AACAD,MAAIE,MAAJ,GAAa,GAAb;AACAJ,OAAKE,GAAL;AACH,CAJD;;AAMAzB,IAAIC,GAAJ,CAAQ,UAACwB,GAAD,EAAMJ,GAAN,EAAWC,GAAX,EAAgBC,IAAhB,EAAyB;AAC7BD,MAAIK,MAAJ,CAAWF,IAAIE,MAAJ,IAAc,GAAzB;AACAT,UAAQC,GAAR,CAAYM,GAAZ;AACAH,MAAIM,IAAJ,CAAS,EAAC,SAASH,IAAII,OAAd,EAAT;AACA,MAAI7B,IAAIiB,GAAJ,CAAQ,KAAR,MAAmB,aAAvB,EAAsC;AAClCC,YAAQC,GAAR,CAAYM,GAAZ;AACH;AACJ,CAPD;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;kBAEezB,G","file":"app.js","sourcesContent":["import 'babel-polyfill'\nimport express from 'express'\nimport bodyParser from 'body-parser'\nimport serveFavicon from 'serve-favicon'\nimport sslRedirect from 'heroku-ssl-redirect'\nimport cookieParser from 'cookie-parser'\nimport path from 'path'\nimport router from './router'\nimport {connectDB} from './models'\nimport {sigtermBE, sigtermFE} from './services/sigterm'\n\n/**\n * Start Express server\n * \n * Moonbot\n * version 2\n * \n * Jan Blažej\n * Vysoká škola ekonomická v Praze\n * V roce 2018\n * \n * Bachelor thesis\n * \n */\nconst app = express()\n\n/**\n * Setup Express server\n * \n */\napp.use(sslRedirect())\napp.use('/public', express.static(__dirname + '../public'))\napp.use(bodyParser.json())\napp.use(bodyParser.urlencoded({ extended: true }))\napp.use(cookieParser())\napp.use(serveFavicon(path.join(__dirname, '../public', 'favicon.ico')))\napp.use(router)\n\napp.set('port', (process.env.PORT || 3030))\n\n/**\n * Run Express server\n * \n */\napp.listen(app.get(\"port\"), () => {\n    console.log(\n      \"App is running at http://localhost:%d in %s mode\",\n      app.get(\"port\"),\n      app.get(\"env\")\n    )\n    console.log(\"Press CMD-C to stop\\n\");\n})\n\n/**\n * Database connection\n * \n */\nconnectDB()\n\n/**\n * CRON services\n * \n */\nsigtermBE()\nsigtermFE()\n\n/**\n * HANDLINGS ERRORS\n * \n */\nlet shuttingDown = false\n\napp.use((req, res, next) => {\n    if (!shuttingDown) return next()\n  \n    res.setHeader('Connection', 'close')\n    const err = new Error('Server is in the process of restarting')\n    err.status = 503\n    next(err)\n})\n\napp.use((req, res, next) => {\n    const err = new Error('Not Found')\n    err.status = 404\n    next(err)\n})\n  \napp.use((err, req, res, next) => {\n    res.status(err.status || 500)\n    console.log(err)\n    res.send({'error': err.message})\n    if (app.get('env') === 'development') {\n        console.log(err)\n    }\n})\n\nimport { createOffice } from './bot/news'\n\n//import { createOffice } from './services/office'\n//createOffice('1', 'jarIE', 'Pondělí', '9:00-12:00')\n//createOffice('2', 'jarIE', 'Úterý', '9:00-12:00')\n//createOffice('3', 'jarIE', 'Středa', '13:00-15:00')\n//createOffice('4', 'jarIE', 'Čtvrtek', '8:00-11:00')\n//createOffice('5', 'jarIE', 'Pátek', '9:00-12:00')\n//createOffice('6', 'jarIE', 'Sobota', 'Zavřeno')\n//createOffice('0', 'jarIE', 'Nedelě', 'Zavřeno')\n\n// sendHeadAndRep('1')\n// import { createDormitory } from './services/dormitory'\n// createDormitory('2', 'Vltava', 'Dagmar Šolarová', 'dagmar.solarova@vse.cz', '+420 224 092 511', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/Kolej+Vltava/@50.0198809,14.4933567,17z/data=!3m1!4b1!4m5!3m4!1s0x470b922a1eea29e1:0x4403a577efccf6d5!8m2!3d50.0198809!4d14.4955454')\n// createDormitory('3', 'Jarov I.', 'Petra Angerová', 'petra.angerova@vse.cz', '+420 224 092 197', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/kolej+Jarov+I/@50.0919837,14.4816273,17z/data=!3m1!4b1!4m5!3m4!1s0x470b9345d7594aa7:0x5054f325ab985a43!8m2!3d50.0919837!4d14.483816')\n// createDormitory('4', 'Jarov I.E', 'Ing. Zuzana Chudobová', 'zuzana.chudobova@vse.cz', '+420 224 092 108', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/search/kolej+jarov+I.E/@50.0920282,14.4815833,17z/data=!3m1!4b1')\n// createDormitory('5', 'Jarov II.', 'Zuzana Fofoňková', 'zuzana.fofonkova@vse.cz', '+420 224 092 010', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/kolej+Jarov+II./@50.0906535,14.4919244,17z/data=!3m1!4b1!4m5!3m4!1s0x470b93384df452eb:0x9ac2a927e12384d8!8m2!3d50.0906535!4d14.4941131')\n// createDormitory('6', 'Jarov III.F', 'Novotná Hana', 'hana.novotna@vse.cz\t', '+420 224 092 313', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/Koleje+Jarov+III.+F/@50.0915304,14.4838884,17z/data=!3m1!4b1!4m5!3m4!1s0x470b93465c66b63f:0x89eb9abafd8070e9!8m2!3d50.0915304!4d14.4860771')\n// createDormitory('7', 'Jarov III.G', 'Kateřina Vykuková', 'vykukovk@vse.cz', '+420 224 092 315', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/Vysok%C3%A1+%C5%A1kola+ekonomick%C3%A1+v+Praze+-+Kolej+Jarov+III.+G/@50.0914537,14.4810951,17z/data=!3m1!4b1!4m5!3m4!1s0x470b9345cef6982b:0x832087338635827a!8m2!3d50.0914537!4d14.4832838')\n// createDormitory('8', 'Rooseveltova kolej', 'Hanáková Eva', 'hanakove@vse.cz', '+420 224 098 199', 'Petra Kowalská', 'petra.kowalska@vse.cz', '+420 224 098 695', 'https://www.google.com/maps/place/Rooseveltova+kolej/@50.1045145,14.4325107,17z/data=!3m1!4b1!4m5!3m4!1s0x470b94c971e317c1:0xf30b5a234d8b5045!8m2!3d50.1045145!4d14.4346994')\n\nexport default app\n"]}